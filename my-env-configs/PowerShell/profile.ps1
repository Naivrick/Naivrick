# === ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ ===
$hour = (Get-Date).Hour
if ($hour -lt 12) { $greet = "Ğ”Ğ¾Ğ±Ñ€Ğ¾Ğµ ÑƒÑ‚Ñ€Ğ¾ â˜€ï¸" }
elseif ($hour -lt 18) { $greet = "Ğ”Ğ¾Ğ±Ñ€Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ ğŸŒ¤ï¸" }
else { $greet = "Ğ”Ğ¾Ğ±Ñ€Ñ‹Ğ¹ Ğ²ĞµÑ‡ĞµÑ€ ğŸŒ™" }

Write-Host ""
Write-Host "`n  $greet, $env:USERNAME!`n" -ForegroundColor Yellow
Write-Host ""

# === Oh My Posh ===
oh-my-posh init pwsh --config "C:\Users\Admin\AppData\Local\Programs\oh-my-posh\themes\kushal.omp.json" | Invoke-Expression 

# === Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ===
if (-not (Get-Variable -Name DESKTOP -ErrorAction SilentlyContinue)) {
    Set-Variable -Name DESKTOP -Value ([Environment]::GetFolderPath("Desktop")) -Option ReadOnly
}
# === Ğ¡Ğ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ ===
function explore { explorer $args } # Ğ‘Ñ‹ÑÑ‚Ñ€Ğ¾ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ğ°Ğ¿ĞºÑƒ Ğ² Ğ¿Ñ€Ğ¾Ğ²Ğ¾Ğ´Ğ½Ğ¸ĞºĞµ

# Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ 'touch' â€” ÑĞ¼ÑƒĞ»Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ¸Ğ¼Ñ‘Ğ½Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¸Ğ· Linux/macOS:
# - ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ Ñ„Ğ°Ğ¹Ğ», ĞµÑĞ»Ğ¸ ĞµĞ³Ğ¾ Ğ½ĞµÑ‚
# - Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ, ĞµÑĞ»Ğ¸ Ñ„Ğ°Ğ¹Ğ» ÑƒĞ¶Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚
function touch {
    param(
        [Parameter(Mandatory = $true, ValueFromPipeline = $true)]
        [string[]]$Path
    )
    process {
        foreach ($item in $Path) {
            # Ğ•ÑĞ»Ğ¸ Ğ¿ÑƒÑ‚ÑŒ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ â€” Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ (Ğ¸Ğ»Ğ¸ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ²Ñ‹Ğ´Ğ°Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ)
            if ([string]::IsNullOrWhiteSpace($item)) {
                Write-Warning "ĞŸÑƒÑÑ‚Ğ¾Ğ¹ Ğ¿ÑƒÑ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ½ Ğ² touch, Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼."
                continue
            }

            # Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒÑĞºÑƒÑ Ğ¿Ğ°Ğ¿ĞºÑƒ. Ğ•ÑĞ»Ğ¸ ĞµÑ‘ Ğ½ĞµÑ‚ â€” Ğ±ÑƒĞ´ĞµÑ‚ $null Ğ¸Ğ»Ğ¸ Ğ¿ÑƒÑÑ‚Ğ°Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ°
            $parent = Split-Path -Path $item -Parent
            $leaf = Split-Path -Path $item -Leaf

            # Ğ•ÑĞ»Ğ¸ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½ â€” Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ñ‚ĞµĞºÑƒÑ‰ÑƒÑ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ
            if ([string]::IsNullOrWhiteSpace($parent)) {
                $fullPath = Join-Path $PWD.Path $leaf
            }
            else {
                # ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµĞ¼ Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ Ğ² Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ñ‹Ğ¹
                $resolvedParent = Resolve-Path -Path $parent -ErrorAction Stop
                $fullPath = Join-Path $resolvedParent.Path $leaf
            }

            if (Test-Path -Path $fullPath) {
                # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ´Ğ°Ñ‚Ñƒ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ
                (Get-Item $fullPath).LastWriteTime = Get-Date
            }
            else {
                # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ñ„Ğ°Ğ¹Ğ» (Ğ¸ Ğ½ĞµĞ´Ğ¾ÑÑ‚Ğ°ÑÑ‰Ğ¸Ğµ Ğ¿Ğ°Ğ¿ĞºĞ¸, ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾)
                $null = New-Item -Path $fullPath -ItemType File -Force
            }
        }
    }
}

# === Aliases ===
Set-Alias ll Get-ChildItem
#Set-Alias gs git status

# === ĞĞ²Ñ‚Ğ¾Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹ ===
Import-Module Terminal-Icons    # Ñ†Ğ²ĞµÑ‚Ğ½Ñ‹Ğµ Ğ¸ĞºĞ¾Ğ½ĞºĞ¸ Ğ´Ğ»Ñ Get-ChildItem
#Import-Module z                 # ÑƒĞ¼Ğ½Ğ°Ñ Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ¿Ğ°Ğ¿ĞºĞ°Ğ¼ (Ğ½ÑƒĞ¶Ğ½Ğ¾ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ)
#Import-Module PSReadLine        # ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ğ°Ñ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

# === ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ ASCII-Ğ°Ñ€Ñ‚ ===
function Show-StartupArt {
    $art = @'
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„â–„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–€â–€â–€â”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â–€â–€â–€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â–„â–ˆâ–ˆâ–„â”€â”€â”€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„â–„â”€â”€â”€â–„â–ˆâ–ˆâ–„â”€â”€â”€â”€â”€
â”€â”€â”€â–„â–ˆâ–ˆâ–ˆâ–€â”€â”€â–„â–ˆâ–ˆâ–ˆâ–ˆâ–€â–€â–€â”€â”€â”€â”€â–€â–€â–€â–ˆâ–ˆâ–ˆâ–ˆâ–„â”€â”€â–€â–ˆâ–ˆâ–ˆâ–„â”€â”€â”€
â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–„â”€â–„â–ˆâ–ˆâ–ˆâ–€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–€â–ˆâ–ˆâ–ˆâ–„â”€â–„â–ˆâ–ˆâ–ˆâ–ˆâ”€â”€
â”€â–ˆâ–ˆâ–ˆâ–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„â”€â”€â”€â”€â”€â”€â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–ˆâ–ˆâ–ˆâ”€
â”€â–ˆâ–ˆâ–€â”€â”€â–ˆâ–ˆâ–ˆâ–€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”€â”€â”€â”€â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”€â–€â–ˆâ–ˆâ–ˆâ”€â”€â–€â–ˆâ–ˆâ”€
â”€â”€â–€â”€â”€â–„â–ˆâ–ˆâ–€â”€â”€â–€â–ˆâ–ˆâ–ˆâ–ˆâ–€â”€â”€â–„â–„â”€â”€â–€â–ˆâ–ˆâ–ˆâ–ˆâ–€â”€â”€â–€â–ˆâ–ˆâ–„â”€â”€â–€â”€â”€
â”€â”€â”€â”€â”€â–ˆâ–ˆâ–ˆâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–€â–€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ˆâ–ˆâ–ˆâ”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”€â”€â”€â”€â”€
â”€â–„â–ˆâ”€â”€â–€â–ˆâ–ˆâ”€â”€â–ˆâ–ˆâ–ˆâ”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â–ˆâ–ˆâ–ˆâ”€â”€â–ˆâ–ˆâ–€â”€â”€â–ˆâ–„â”€
â”€â–ˆâ–ˆâ–ˆâ”€â”€â–ˆâ–ˆâ–ˆâ”€â–ˆâ–ˆâ–ˆâ”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â–ˆâ–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ”€â”€â–ˆâ–ˆâ–ˆâ”€
â”€â–€â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„â–ˆâ–ˆâ–€â”€
â”€â”€â–€â–ˆâ–ˆâ–ˆâ–€â”€â–€â–ˆâ–ˆâ–ˆâ–ˆâ”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–€â”€â–€â–ˆâ–ˆâ–ˆâ–€â”€â”€
â”€â”€â”€â–€â–ˆâ–ˆâ–ˆâ–„â”€â”€â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”€â”€â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â”€â”€â–„â–ˆâ–ˆâ–ˆâ–€â”€â”€â”€
â”€â”€â”€â”€â”€â–€â–ˆâ–ˆâ–ˆâ”€â”€â”€â”€â–€â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–€â–€â”€â”€â”€â–ˆâ–ˆâ–ˆâ–€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”€â”€â–€â”€â”€â”€â”€â”€â–„â–„â–„â”€â”€â”€â–ˆâ–ˆâ”€â”€â”€â–„â–„â–„â”€â”€â”€â”€â”€â”€â–€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–€â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
'@

    # Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ°Ñ€Ñ‚ Ñ Ğ¼ÑĞ³ĞºĞ¸Ğ¼ ÑĞµÑ€Ñ‹Ğ¼ Ñ†Ğ²ĞµÑ‚Ğ¾Ğ¼ (Ğ¸Ğ»Ğ¸ Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸ ÑĞ²Ğ¾Ğ¹)
    Write-Host $art -ForegroundColor DarkGray
    Write-Host ""
}

if (-not (Get-Variable -Name _ProfileArtShown -ErrorAction SilentlyContinue)) {
    Show-StartupArt
    Set-Variable -Name _ProfileArtShown -Value $true -Option ReadOnly -Scope Global
}